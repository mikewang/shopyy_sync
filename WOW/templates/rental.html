<!DOCTYPE html>
<html lang="en">
 <head>
  <!-- Required meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Bootstrap CSS -->
  <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/css/bootstrap-theme.css" rel="stylesheet" />
  <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/css/bootstrap-theme.min.css" rel="stylesheet" />
  <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/css/bootstrap.min.css" rel="stylesheet" />
  <title>Sign up</title>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->a
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <!-- Custom scripts for this template -->
 <script src="{{ url_for('static', filename='js/jquery.md5.js') }}"></script>

  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/js/affix.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/js/alert.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/js/alert.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/js/bootstrap.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.0.1/js/button.js"></script>

 </head>
 <body>

  <div class="container">
   <div class="row clearfix">
    <div class="col-md-12 column">
     <ul class="nav nav-tabs">
      <li class="active"> <a href="#">首页</a> </li>
      <li> <a href="#">简介</a> </li>
      <li class="disabled"> <a href="#">信息</a> </li>
      <li class="dropdown pull-right"> <a href="#" data-toggle="dropdown" class="dropdown-toggle">下拉<strong class="caret"></strong></a>
       <ul class="dropdown-menu">
        <li> <a href="#">操作</a> </li>
        <li> <a href="#">设置栏目</a> </li>
        <li> <a href="#">更多设置</a> </li>
        <li class="divider"> </li>
        <li> <a href="#">分割线</a> </li>
       </ul> </li>
     </ul>
     <h3> WOW - Rental Service </h3>
    </div>
    <div class="col-md-12 column">
     <form role="form">

      <div class="form-group">
       <label for="rs_id">Rental Service ID</label>
       <input type="text" readonly="readonly" class="form-control" id="rs_id" value={{rs_id}}/>
      </div>
      <div class="form-group">
       <label for="Pickup_Location">Pickup Location</label>
       <input type="text" class="form-control" id="Pickup_Location" />
      </div>
      <div class="form-group">
       <label for="Dropoff_Location">Dropoff Location</label>
       <input type="text" class="form-control" id="Dropoff_Location" />
      </div>
      <div class="form-group">
       <label for="Pickup_Date">Pickup Date</label>
       <input type="date" class="form-control" id="Pickup_Date" />
      </div>
      <div class="form-group">
       <label for="Dropoff_Date">Dropoff Date</label>
       <input type="date" class="form-control" id="Dropoff_Date" />
      </div>
      <div class="form-group">
       <label for="Start_Odometer">Start Odometer</label>
       <input type="text" class="form-control" id="Start_Odometer" />
      </div>
      <div class="form-group">
       <label for="End_Odometer">End Odometer</label>
       <input type="text" class="form-control" id="End_Odometer" />
      </div>
      <div class="form-group">
       <label for="Daily_Odometer_Limit">Daily Odometer Limit</label>
       <input type="text" class="form-control" id="Daily_Odometer_Limit" />
      </div>
      <div class="form-group">
       <label for="rental_rate">rental rate</label>
       <input type="text" class="form-control" id="rental_rate" />
      </div>
      <div class="form-group">
       <label for="rental_fee">rental fee</label>
       <input type="text" class="form-control" id="rental_fee" />
      </div>
      <div class="form-group">
       <label for="rental_amount">rental amount</label>
       <input type="text" class="form-control" id="rental_amount" />
      </div>
      <div class="form-group">
       <label for="really_amount">really amount</label>
       <input type="text" class="form-control" id="really_amount" />
      </div>
             <div class="form-group">
       <label for="Vehicle_Info">Vehicle Info</label>
       <input type="text" class="form-control" id="Vehicle_Info" />
      </div>
      <div class="form-group">
       <label for="wow_userid">WOW User ID</label>
       <input type="text" class="form-control" id="wow_userid" />
      </div>
      <br />
      <div id="success"></div>
      <button type="button" class="btn btn-primary" id="saveRentalButton">Save</button>
     </form>
    </div>
   </div>
  </div>
  <hr />
  <!-- Footer -->
  <footer>
   <div class="container">
    <div class="row clearfix">
     <p class="copyright text-muted">Copyright &copy; WOW</p>
    </div>
   </div>
  </footer>
<script>
   $(document).ready(function() {
    var d = new Date();
    var t = d.getTime();
    var timestamp = Math.round(d / 1000);
    var username = $.cookie("username");
    var password = $.cookie("password");
    var token = $.md5(username + password + timestamp);
    if (username != null && password != null) {
        $.ajax({
            type: "GET",
            url: "/user/" + username,
            beforeSend: function(request) {
                request.setRequestHeader("token", token);
                request.setRequestHeader("timestamp", timestamp);
            },
            data: {},
            dataType: 'json',
            success: function(result) {
                var r = JSON.parse(result);
                var stat = r["stat"];
                if (stat == 1) {
                    // login success.

                    $.ajax({
                        type: "GET",
                        url: "/rental/" + username,
                        beforeSend: function(request) {
                            request.setRequestHeader("token", token);
                            request.setRequestHeader("timestamp", timestamp);
                        },
                        data: {"rs_id":$("#rs_id").val()},
                        dataType: "json",
                        success: function(result) {
                            var r = JSON.parse(result);
                            var stat = r["stat"];
                            if (stat == 1) {
                              var rental = r["rental"];
                              $("#rs_id").val(rental["rs_id"]);
                              $("#Pickup_Location").val(rental["Pickup_Location"]);
                              $("#Dropoff_Location").val(rental["Dropoff_Location"]);
                              $("#Pickup_Date").val(rental["Pickup_Date"]);


                            } else {
                              alert("token is error.")

                            }
                        }
                    });
                } else {
                    $(location).attr('href', '/');
                }
            }
        });

    } else {
        $(location).attr('href', '/');
    }




$("#saveRentalButton").click(function() {

    var data = {
        "rs_id": $("#rs_id").val(),
        "Pickup_Location": $("#Pickup_Location").val(),
        "Dropoff_Location": $("#Dropoff_Location").val(),
        "Pickup_Date": $("#Pickup_Date").val(),
    };

    $.ajax({
        type: "POST",
        url: "/rental",
        beforeSend: function(request) {
            request.setRequestHeader("username", username);
            request.setRequestHeader("token", token);
            request.setRequestHeader("timestamp", timestamp);
        },
        data: data,
        dataType: 'json',
        success: function(result) {
            var r = JSON.parse(result);
            var stat = r["stat"];
            if (stat == 1) {
                alert("save success.");

            } else {
                alert("save failure.");
            }
        }
    });

});

});
</script>


 </body>
</html>